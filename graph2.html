<!DOCTYPE html>
<html>
	<style>
		#title {
			display: block;
			margin-left: auto;
      			margin-right: auto;
		}
	</style>
	<script src="https://d3js.org/d3.v4.min.js"></script>
  	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

  	<body>
		<div id="title">
			<h1>Wines of the United States</h1>
    		</div>
		<!--Navigation-->
    		<div>
      			<a href="index.html">Back</a>
    		</div>

    		<div id="holder">
    		</div>

    		<script>
			var data = d3.csv("states.csv", function(d) {
				return {
					number : +d.number,
					record : +d.record,
					state: d.state,
				};
			}, function(error, rows) {
				console.log(rows)
			});
			var states = d3.map(data, function(d) { return d.state});
			var margin = {top: 5, right: 5, bottom: 50, left: 50};
			var fullWidth = 500;
			var fullHeight = 500;
			var width = fullWidth - margin.right - margin.left;
			var height = fullHeight - margin.top - margin.bottom;

			var svg = d3.select("#holder")
				.append('svg')
				.attr('width', fullWidth)
				.attr('height', fullHeight)
				.append('g')
				.attr('transform','translate(' + margin.left + "," + margin.top + ')');
			var stateScale = d3.scaleBand()
				.domain(states)
				.range([0,width])
				.paddingInner(0.1);
			var numberScale = d3.scaleLinear()
				.domain([0, d3.max(data, function(d) { return d.number;})])
				.range([0, height])
				.nice()

			var xAxis = d3.axisBottom(stateScale);
			var yAxis = d3.axisLeft(numberScale);

			svg.append('g')
				.classed('x axis', true)
				.attr('transform', 'translate(0,' + height + ')')
				.call(xAxis);

			var yAxisEle = svg.append('g')
				.classed('y axis', true)
				.call(yAxis);

			var yText = yAxisEle.append('text')
				.attr('transform', 'rotate(-90)translate(-' + height/2 + ',0)')
				.style('text-anchor', 'middle')
				.attr('dy', '-2.5em')
				.attr('fill', 'black')
				.text('Number of Wines');

			var bandwidth = stateScale.bandwidth();
			var barHolder = svg.append('g')
				.classed('bar-holder', true);

			var bars = barHolder.selectAll('rect.bar')
				.data(data)
				.enter()
				.append('rect')
				.classed('bar', true)
				.attr('x', function(d,i) { return stateScale(d.state)})
				.attr('width', bandwidth)
				.attr('y', function(d) { return numberScale(d.number);})
				.attr('height', function(d) { return height - numberScale(d.number)})
				.attr('fill', 'blue');
		</script>
	</body>
</html>
